import{createJWT as e,verifyJWT as r}from"did-jwt";var t=/^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+\/=]*$/,n="https://www.w3.org/2018/credentials/v1",i="VerifiableCredential",o="VerifiablePresentation";function a(e){if(!e.match(t))throw new TypeError('"'+e+'" is not a valid JWT format')}function c(e){if(!(Number.isInteger(e)&&e<1e11))throw new TypeError('"'+e+'" is not a unix timestamp in seconds')}function s(e){if(e.length<1||!e.includes(n))throw new TypeError('@context is missing default context "'+n+'"')}var l=function(e,t){try{return Promise.resolve(r(e,{resolver:t})).then(function(e){return d(e.payload),e})}catch(e){return Promise.reject(e)}},u=function(e,t){try{return Promise.resolve(r(e,{resolver:t})).then(function(e){var r;return(r=e.payload)instanceof Object&&r.sub&&r.iss&&r.claim&&r.iat&&(e.payload=function(e){var r=e.iat,t=e.nbf,o=e.vc,a=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&-1===r.indexOf(n)&&(t[n]=e[n]);return t}(e,["iat","nbf","claim","vc"]),c=Object.assign({},a,{nbf:t||r,vc:{"@context":[n],type:[i],credentialSubject:e.claim}});return o&&(e.issVc=o),c}(e.payload)),v(e.payload),e})}catch(e){return Promise.reject(e)}},f=function(r,t){try{return d(r),Promise.resolve(e(r,{issuer:t.did,signer:t.signer,alg:t.alg||"ES256K-R"}))}catch(e){return Promise.reject(e)}},p=function(r,t){try{return v(r),Promise.resolve(e(r,{issuer:t.did,signer:t.signer,alg:t.alg||"ES256K-R"}))}catch(e){return Promise.reject(e)}};function v(e){s(e.vc["@context"]),function(e){if(e.length<1||!e.includes(i))throw new TypeError('type is missing default "'+i+'"')}(e.vc.type),function(r){if(0===Object.keys(e.vc.credentialSubject).length)throw new TypeError("credentialSubject must not be empty")}(),e.nbf&&c(e.nbf),e.exp&&c(e.exp)}function d(e){if(s(e.vp["@context"]),function(e){if(e.length<1||!e.includes(o))throw new TypeError('type is missing default "'+o+'"')}(e.vp.type),e.vp.verifiableCredential.length<1)throw new TypeError("vp.verifiableCredential must not be empty");for(var r=0,t=e.vp.verifiableCredential;r<t.length;r+=1)a(t[r]);e.exp&&c(e.exp)}export{l as verifyPresentation,u as verifyCredential,f as createPresentation,p as createVerifiableCredential,v as validateVerifiableCredentialAttributes,d as validatePresentationAttributes};
//# sourceMappingURL=index.mjs.map
